name: Test-Security

on: 
  push:
    branches-ignore: [ main ]

jobs:
    build :
      runs-on: ${{matrix.os}}
      strategy:
        matrix:
          os: [ubuntu-latest, windows-latest]
          python-version: ["3.11", "3.12"]
      steps:
        - name: Checkout code
          uses: actions/checkout@v4

        - name: Setup Python ${{matrix.python-version}}
          uses: actions/setup-python@v5
          with: 
            python-version: ${{matrix.python-version}}

        - name: Display Python version
          run: |
            python -c "import sys; print(sys.version)"
        
        - name: Install Dependencies
          run: |
            python -m pip install --upgrade pip
            pip install -r requirements.txt
        
        - name: Lint code with Flake8
          run: |
            flake8 --ignore=E501,F401

        # - name: Run Unit Tests with Pytest
        #   run: |
        #     pytest -v

        - name: Security Scan with Bandit
          run: |
            pip install bandit
            bandit -r .

        - name: Run Pip Audit
          uses: pypa/gh-action-pip-audit@v1.1.0
          with:
            inputs: requirements.txt
            summary: true